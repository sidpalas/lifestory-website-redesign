<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Lifestory Kids Books</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
        <link rel="stylesheet" href="./css/master.css">
        <link href="https://fonts.googleapis.com/css?family=Slabo+27px" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">

        <script src="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.js"></script>
        <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.css" />

    </head>
    <body>
        <header>
            <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom box-shadow">
            <h2 class="my-0 mr-md-auto font-weight-normal"><a class="text-dark no-underline" href="index.html">Lifestory Kids Books</a></h2>
            <nav class="my-2 my-md-0 mr-md-3">
              <a class="p-2 text-dark" href="index.html">Home</a>
              <a class="p-2 text-dark" href="about.html">About</a>
              <a class="p-2 text-dark" href="news.html">News</a>
              <a class="p-2 text-dark" href="purchase.html">Purchase</a>
              <a class="p-2 text-dark" href="photos.html">Take Photos</a>
            </nav>
            </div>
        </header>

        <!-- Modal -->
        <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Please provide your email address&#42;</h5>
              </div>
              <div class="modal-body">
                  <form>
                    <div>
                      <input id="email" type="text" placeholder="Email...">
                    </div>
                    <!-- <div>
                      <input id="password" type="password" placeholder="Purchase code...">
                    </div> -->
                  </form>
              </div>
              <div class="modal-footer">
                <button type="button" id="skipLogin" class="btn btn-secondary" data-dismiss="modal">Skip Login (for now)</button>
                <button type="button" id="sign-in" class="btn btn-primary" data-dismiss="modal">Validate User</button>
              </div>
              <div class="mx-2">
                  <h6>&#42;Login link will be sent to your email</h6>
              </div>
            </div>
          </div>
        </div>



        <div class="row outer-row text-center mx-1">
            <div class="col-xl-3 col-sm-2 d-none d-sm-block">
            </div>
            <div class="col-xl-6 col-sm-8 col">
                <h2>Taking the photos</h2>
                <p>Any camera works well, including the one on your smart phone. Your main focus will be getting your kid’s personality to come out.</p>
                <p>You don’t have to replicate the poses or expressions exactly. In fact, a few silly photos make for the most fun and unique books.</p>
                <ol>
                    <li><strong>Find a shady spot outside.</strong> The golden hour (about an hour before sunset) works great, or a well-shaded (but not dappled) area in the daytime. Bright sun isn’t good, the harsh shadows won’t integrate well with the book.</li>
                    <li>Frame the shot to <strong>get a good amount of room around your kid</strong>, and a good portion of their body. If part of their hair or face gets cut off, it makes the integration tough. Err on the side of space around your kid.</li>
                    <li>Design the photoshoot to <strong>the type of fun your kid likes to have</strong>. Do they like fantasies? Build a story for them to react to (“there’s a lion over there and you have to shout at him to get away!”) Do they like to act? Prompt them with a description of the pose (“make a sad face like you can’t find your teddy and you’re worried about her.”)</li>
                    <li>Do your best to keep <strong>your kid’s hands off of their faces</strong>. Sometimes kids default to this for sleeping or the frightened expressions, but just lead them to strike poses with their hands away from their faces.</li>
                </ol>
            </div>
            <div class="col-xl-3 col-sm-2 d-none d-sm-block">
            </div>
        </div>
        <hr>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4><em>Note: If you are using a smartphone, the "Choose File" buttons will open the device camera!</em></h4>
                <hr>
                <h4 class="lead heading">01. Back of the head</h4>
                <p>This one is easy! Just get your kid’s hair in a way that they usually wear it, and get a simple shot with their neck included!</p>
                <img class="my-1" id="photoDisplay01" src="images/examplePhotos/examplePhoto01.png" alt="example photo #1" width="250px">
                <input type="file" id="photoUpload01" accept="image/*" capture="camera" onchange="handleFiles(this.files, '01')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">02. Happy smiley kid</h4>
                <p>This is the baseline happy expression for the setup of the story. Just a nice, natural smile! Again, include some neck ;)</p>
                <img class="my-1" id="photoDisplay02" src="images/examplePhotos/examplePhoto02.png" alt="example photo #2" width="250px">
                <input type="file" id="photoUpload02" accept="image/*" capture="camera" onchange="handleFiles(this.files, '02')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">03. Happy Sleep</h4>
                <p>A shot of your kid happily sleeping. Imagine a good dream.</p>
                <img class="my-1" id="photoDisplay03" src="images/examplePhotos/examplePhoto03.png" alt="example photo #3" width="250px">
                <input type="file" id="photoUpload03" accept="image/*" capture="camera" onchange="handleFiles(this.files, '03')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">04. Sad Sleep</h4>
                <p>A sour frown as your kid goes to sleep.</p>
                <img class="my-1" id="photoDisplay04" src="images/examplePhotos/examplePhoto04.png" alt="example photo #4" width="250px">
                <input type="file" id="photoUpload04" accept="image/*" capture="camera" onchange="handleFiles(this.files, '04')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">05. Silly</h4>
                <p>Get your kid being wild, wacky, and silly. Tongue out is great, funny eyes are great. Just make sure they are facing the camera head-on.</p>
                <img class="my-1" id="photoDisplay05" src="images/examplePhotos/examplePhoto05.png" alt="example photo #5" width="250px">
                <input type="file" id="photoUpload05" accept="image/*" capture="camera" onchange="handleFiles(this.files, '05')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">06. Glee!</h4>
                <p>One of the happiest, most adventurous set- tings of the book. This is just pure, unadul- erated happy kid. Get a big smile however you do :)</p>
                <img class="my-1" id="photoDisplay06" src="images/examplePhotos/examplePhoto06.png" alt="example photo #6" width="250px">
                <input type="file" id="photoUpload06" accept="image/*" capture="camera" onchange="handleFiles(this.files, '06')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">07. Worried</h4>
                <p>Here is the story beat where your kid loses their sidekick. If your reader does sad bet- ter than worried, that’s fine. Anything from a frown to a furrowed brow works well!</p>
                <img class="my-1" id="photoDisplay07" src="images/examplePhotos/examplePhoto07.png" alt="example photo #7" width="250px">
                <input type="file" id="photoUpload07" accept="image/*" capture="camera" onchange="handleFiles(this.files, '07')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">08. Sly Operator (45°)</h4>
                <p>This is your little one slipping away from a foe. An eyebrow raise, a wink, anything they do that shows they’re in the know.</p>
                <img class="my-1" id="photoDisplay08" src="images/examplePhotos/examplePhoto08.png" alt="example photo #8" width="250px">
                <input type="file" id="photoUpload08" accept="image/*" capture="camera" onchange="handleFiles(this.files, '08')" />
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">09. Falling...</h4>
                <p>Your kid is flowing down a magical water- fall. “Ahhhhh,” or “wheee” depending on their personality.</p>
                <img class="my-1" id="photoDisplay09" src="images/examplePhotos/examplePhoto09.png" alt="example photo #9" width="250px">
                <input type="file" id="photoUpload09" accept="image/*" capture="camera" onchange="handleFiles(this.files, '09')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">
                <h4 class="lead heading">10. GRRRR! (45°)</h4>
                <p>What’s your kid got for a growl?! Have them do their biggest, meanest growl, baring their teeth and all. Have them look off to the side of the camera for the right angle.</p>
                <img class="my-1" id="photoDisplay10" src="images/examplePhotos/examplePhoto10.png" alt="example photo #10" width="250px">
                <input type="file" id="photoUpload10" accept="image/*" capture="camera" onchange="handleFiles(this.files, '10')"/>
                <hr>
            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>
        <div class="row outer-row text-center">
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
            <div class="col-xl-4 col-sm-6 col text-center">

                <!-- Button trigger modal -->
                <button type="button" class="btn btn-primary" id="loginModalButton" data-toggle="modal" data-target="#loginModal">
                  Log In
                </button>
                <!-- Button trigger modal -->
                <button type="button" id="submitPhotos" class="btn btn-primary" disabled=false>
                  Submit Photos
                </button>

            </div>
            <div class="col-xl-4 col-sm-3 d-none d-sm-block">
            </div>
        </div>

        <hr>
        <footer class="container">
          <div class="row">
            <div class="col">
              <small class="d-block mb-2 text-muted">&copy; Lifestory Kids Books 2018</small>
              <small class="d-block"><a href="mailto:jake@lifestorykidsbooks.com">jake@lifestorykidsbooks.com</a></small>
              <small class="d-block"><a href="mailto:alison@lifestorykidsbooks.com">alison@lifestorykidsbooks.com</a></small>
              <!-- <small class="d-block"><a href="mailto:sid@lifestorykidsbooks.com">sid@lifestorykidsbooks.com</a></small> -->
          </div>
          <!-- <div class="col">
          </div>
          <div class="col text-right">
          </div> -->
        </footer>
        <script type="text/javascript">
            function handleFiles(files, imgNum) {
              for (var i = 0; i < files.length; i++) {
                var file = files[i];
                uploadedImages[parseInt(imgNum)-1] = file;
                if (!file.type.startsWith('image/')){ continue }

                let picId = "photoDisplay" + imgNum;
                var img = document.getElementById(picId);
                img.file = file;

                var reader = new FileReader();
                reader.onload = (function(aImg) { return function(e) { aImg.src = e.target.result; }; })(img);
                reader.readAsDataURL(file);
              }
            }
        </script>
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

        <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-storage.js"></script>

        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyD8IEpw9EJ-wtP18T7UY-Z8gZTUXG1fF4o",
            authDomain: "lifestory-181703.firebaseapp.com",
            databaseURL: "https://lifestory-181703.firebaseio.com",
            projectId: "lifestory-181703",
            storageBucket: "lifestory-181703.appspot.com",
          };
          firebase.initializeApp(config);
          // firebase.auth().signOut();
          var uploadedImages = [];
        </script>

        <!--Handle auth events-->
        <script>
          firebase.auth().onAuthStateChanged(function(user){
            window.user = user;
            if (window.user != null){
                document.querySelector('#loginModalButton').disabled = true;
                document.querySelector('#loginModalButton').innerText = "Already Logged In";
            }
          });
        </script>

        <!--Handle page events-->
        <script>
            var actionCodeSettings = {
                url: "https://sidpalas.com/lifestory-website-redesign/photos.html",
                // This must be true.
                handleCodeInApp: true
                };

          document.querySelector('#sign-in').addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            var email = document.querySelector('#email').value;
            var auth = firebase.auth().sendSignInLinkToEmail(email, actionCodeSettings)
              .then(function() {
                // The link was successfully sent. Inform the user.
                // Save the email locally so you don't need to ask the user for it again
                // if they open the link on the same device.
                window.localStorage.setItem('emailForSignIn', email);
                alert('Email with log in link sent!')
              })
              .catch(function(error) {
                // Some error occurred, you can inspect the code: error.code
              });
            });


          document.querySelector('#submitPhotos').addEventListener('click', function(e) {
            var ref = firebase.storage().ref();
            console.log(uploadedImages);
            for (let i=0;i<uploadedImages.length;i++){
                var img = uploadedImages[i];
                var imgNum = i + 1
                var task = ref.child(user.email + '_dreambook_' + String(imgNum)).put(img).then(function(snapshot) {
                  console.log('Uploaded image' + String(imgNum));
                    });
                }
          });
        </script>

        <script type="text/javascript">
            $(window).on('load', function(){
                // Confirm the link is a sign-in with email link.
                if (firebase.auth().isSignInWithEmailLink(window.location.href)) {
                  // Additional state parameters can also be passed via URL.
                  // This can be used to continue the user's intended action before triggering
                  // the sign-in operation.
                  // Get the email if available. This should be available if the user completes
                  // the flow on the same device where they started it.
                  var email = window.localStorage.getItem('emailForSignIn');
                  if (!email) {
                    // User opened the link on a different device. To prevent session fixation
                    // attacks, ask the user to provide the associated email again. For example:
                    email = window.prompt('Please provide your email for confirmation');
                  }
                  // The client SDK will parse the code from the link for you.
                  firebase.auth().signInWithEmailLink(email, window.location.href)
                    .then(function(result) {
                      // Clear email from storage.
                      window.localStorage.removeItem('emailForSignIn');
                      // You can access the new user via result.user
                      // Additional user info profile not available via:
                      // result.additionalUserInfo.profile == null
                      // You can check if the user is new or existing:
                      // result.additionalUserInfo.isNewUser
                      console.log('logged in via link!')
                    })
                    .catch(function(error) {
                      // Some error occurred, you can inspect the code: error.code
                      // Common errors could be invalid email and invalid or expired OTPs.
                    });
                }

                if (window.user == null){
                    console.log(window.user);
                    $('#loginModal').modal('show');
                }
            });
        </script>

    </body>
</html>
